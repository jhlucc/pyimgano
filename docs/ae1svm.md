
### **AE1SVM 算法**

#### **阶段一：模型训练 (联合优化)**

**目标**：让自编码器和单类SVM协同工作，学习“正常”数据的模式。

1.  **输入**：一张正常的、无缺陷的图片。

2.  **步骤 1：编码器 (Encoder)**
    * 图片进入编码器，被压缩成一个低维的特征向量（也叫“潜在向量”）。这就像是为图片画了一幅高度浓缩的“草稿”。

3.  **流程分叉 (并行处理)**：
    这个“草稿”（潜在向量）会同时进入两条处理路径。

    * **路径 A (自编码器路径):**
        * **步骤 2a. 解码器 (Decoder)**：解码器接收“草稿”，并尝试将它恢复成原始的、高维度的图片。
        * **步骤 3a. 重构的图片**：解码器输出一张“重构图”。
        * **计算 A. 重构损失**：比较“原图”和“重构图”的差异（例如，计算均方误差MSE）。我们的目标是让这个损失尽可能小，即重构得尽可能像。

    * **路径 B (SVM 路径):**
        * **步骤 2b. 随机傅里叶变换 (RFF)**：潜在向量（“草稿”）进入RFF层。这是一个数学加速技巧，目的是帮助SVM能更高效地学习复杂的边界。
        * **步骤 3b. 单类SVM层**：经过RFF变换后的特征进入SVM层。SVM的目标是学习一个“边界”，将所有正常的点都“圈”在边界的一侧。
        * **计算 B. SVM损失**：如果某个正常点的特征跑到了“边界”错误的一侧，就会产生SVM损失。我们的目标是让这个损失也尽可能小。

4.  **损失汇合与更新**：
    * **总损失 = α * (重构损失) + (SVM损失)**
    * 这个组合起来的总损失是算法的精髓。程序会根据这个总损失，**同时更新**编码器、解码器和SVM的所有参数。
    * **SVM损失在这里的关键作用**：它像一个“指导老师”，在训练时不断地强迫编码器把所有正常图片的“草稿”都映射到潜在空间中一个非常紧凑、聚集的区域，为异常检测创造一个更有利的特征空间。

---

#### **阶段二：预测/推理 (只用自编码器)**

**目标**：判断一张新图片是否异常。

1.  **输入**：一张新的、待检测的图片。

2.  **步骤 1：编码器 (Encoder)**
    * 新图片通过**训练好的**编码器，被压缩成一个潜在向量。

3.  **步骤 2：解码器 (Decoder)**
    * 这个潜在向量通过**训练好的**解码器，被重构出一张新图片。

4.  **计算最终异常分数**：
    * **异常分数 = 重构误差**
    * 我们计算输入的“新图”和模型输出的“重构图”之间的差异。
    * **如果新图是正常的**：由于模型在训练时见过大量类似的正常图片，它能很好地重构它，因此**重构误差很小**。
    * **如果新图是异常的（有缺陷）**：模型从未见过这种模式，无法有效地重构它（比如缺陷区域会变得模糊或扭曲），因此**重构误差很大**。

这个纯文字版本应该能让您清晰地理解每个部分的作用和它们之间的关系了。